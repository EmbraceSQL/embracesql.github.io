"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3953],{3642:(e,s,n)=>{n.d(s,{ZP:()=>a});var r=n(5893),t=n(1151);function l(e){const s={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsx)(s.p,{children:"You are going to need:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"NodeJs >= 18"}),"\n",(0,r.jsx)(s.li,{children:"PostgreSQL >= 14"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"These examples assume you are running locally with your shell able to connect\nto your PostgreSQL with:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"psql\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Create a new database ",(0,r.jsx)(s.code,{children:"dvdrental"})," on your local PostgeSQL server."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:'curl "https://embracesql.github.io/dvdrental.sql" | psql\n'})})]})}function a(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},1849:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>x,contentTitle:()=>p,default:()=>g,frontMatter:()=>d,metadata:()=>h,toc:()=>u});var r=n(5893),t=n(1151);const l='import { EmbraceSQLClient } from "./dvdrental-browser";\n\nconst client = new EmbraceSQLClient({ url: "http://localhost:4444" });\n\nconst actor = await client.Public.Tables.Actor.ActorPkey.read({ actorId: 1 });\n\nconsole.log(actor);\n',a='import { EmbraceSQLExpressApp } from "./dvdrental";\n\n// this is an express application\nconst app = await EmbraceSQLExpressApp(\n  "postgres://postgres:postgres@localhost/dvdrental",\n);\napp.listen(4444);\n',c='{\n  "extends": "@embracesql/shared/tsconfig/tsconfig.json"\n}\n';var i=n(9286),o=n(3642);const d={},p="Express",h={id:"express",title:"Express",description:"EmbraceSQL generates an Express Application object suitable for mounting",source:"@site/docs/express.mdx",sourceDirName:".",slug:"/express",permalink:"/docs/express",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"embracesqlcli",permalink:"/docs/cli"},next:{title:"Middleware",permalink:"/docs/middleware"}},x={},u=[{value:"Steps",id:"steps",level:2},{value:"Generate an Express Server",id:"generate-an-express-server",level:3},{value:"Code up an Express Server",id:"code-up-an-express-server",level:3},{value:"Test your Express",id:"test-your-express",level:3},{value:"Generate a Client",id:"generate-a-client",level:3},{value:"Test your Client",id:"test-your-client",level:3}];function j(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"express",children:"Express"}),"\n",(0,r.jsxs)(s.p,{children:["EmbraceSQL generates an Express ",(0,r.jsx)(s.a,{href:"https://expressjs.com/en/api.html#app",children:(0,r.jsx)(s.code,{children:"Application"})})," object suitable for mounting\nat any location with ",(0,r.jsx)(s.a,{href:"https://expressjs.com/en/api.html#app.use",children:(0,r.jsx)(s.code,{children:"use"})})," into an existing express setup, or run directly\nwith ",(0,r.jsx)(s.a,{href:"https://expressjs.com/en/api.html#app.listen",children:(0,r.jsx)(s.code,{children:"listen"})}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["This server provides full access to ",(0,r.jsx)(s.a,{href:"./autocrud",children:"AutoCRUD"})," and can be\nextended with your own ",(0,r.jsx)(s.a,{href:"./sql",children:"SQL"}),"."]}),"\n",(0,r.jsx)(o.ZP,{}),"\n",(0,r.jsx)(s.h2,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(s.p,{children:["Here is a step by step guide to create an ",(0,r.jsx)(s.code,{children:"Express"})," server and a ",(0,r.jsx)(s.code,{children:"fetch"})," client."]}),"\n",(0,r.jsx)(s.h3,{id:"generate-an-express-server",children:"Generate an Express Server"}),"\n",(0,r.jsx)(s.p,{children:"Go into a nice blank directory."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"npm install @embracesql/express\nnpm pkg set type=module\nmkdir -p ./src\nnpx embracesqlcli generate express --database postgres://postgres:postgres@localhost/dvdrental > ./src/dvdrental.ts\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Notice that this creates a ",(0,r.jsx)(s.code,{children:"module"})," type for you ",(0,r.jsx)(s.code,{children:"package.json"}),". This matches\nthe ",(0,r.jsx)(s.code,{children:"tsconfig.json"})," defaults provided."]}),"\n",(0,r.jsx)(s.h3,{id:"code-up-an-express-server",children:"Code up an Express Server"}),"\n",(0,r.jsxs)(s.p,{children:["We provide handy tsconfig settings that work great with ",(0,r.jsx)(s.code,{children:"tsx"})," and ",(0,r.jsx)(s.code,{children:"typescript"})," 5+."]}),"\n",(0,r.jsx)(s.p,{children:"Create two files as shown."}),"\n",(0,r.jsx)(i.Z,{language:"json",title:"tsconfig.json",children:c}),"\n",(0,r.jsx)(i.Z,{language:"typescript",title:"./src/express.ts",children:a}),"\n",(0,r.jsx)(s.h3,{id:"test-your-express",children:"Test your Express"}),"\n",(0,r.jsx)(s.p,{children:"Start that server:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"npx tsx ./src/express.ts\n"})}),"\n",(0,r.jsx)(s.p,{children:"And curl for some data:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:'curl -X POST http://localhost:4000 \\\n   -H \'Content-Type: application/json\' \\\n   -d \'{"operation":"Public.Tables.Actor.ByActorId.read","parameters":{"actorId": 1}}\'\n'})}),"\n",(0,r.jsx)(s.h3,{id:"generate-a-client",children:"Generate a Client"}),"\n",(0,r.jsxs)(s.p,{children:["It's fun to ",(0,r.jsx)(s.code,{children:"curl"})," and all, but TypeScript is about types and autocompletion."]}),"\n",(0,r.jsxs)(s.p,{children:["Generate a fully typed ",(0,r.jsx)(s.code,{children:"fetch"})," wrapping client."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"npm install @embracesql/client\nnpx embracesqlcli generate client --database postgres://postgres:postgres@localhost/dvdrental > ./src/dvdrental-browser.ts\n"})}),"\n",(0,r.jsx)(s.h3,{id:"test-your-client",children:"Test your Client"}),"\n",(0,r.jsx)(s.p,{children:"Create one file as shown. For fun, try typing it to get a sense of\nthe autocomplete."}),"\n",(0,r.jsx)(i.Z,{language:"typescript",title:"./src/client.ts",children:l}),"\n",(0,r.jsx)(s.p,{children:"Now run it!"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"npx tsx ./src/client.ts\n"})})]})}function g(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(j,{...e})}):j(e)}}}]);